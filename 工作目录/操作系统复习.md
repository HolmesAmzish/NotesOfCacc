# 操作系统概述

# 进程与线程

## 多道程序与并发执行

资源共享性、失去了封闭性和可再现性、相互制约性。

## 进程

进程是能和其他程序并行执行的程序段在某数据集合上的一次运行过程，是系统资源分配和调度的一个独立单位。

基本进程状态：

1. 就绪 Ready
2. 运行 Running
3. 阻塞 Blocked / 等待 Waiting

进程实体由三部分组成，分别为**程序**、**数据**和**进程控制块PCB**。

## 线程

线程是进程中的一个实体，是比进程更小的能独立运行的基本单位，不独立拥有资源。

进程是资源的拥有者，有独立地址空间，不是处理器调度基本单位。线程不独立拥有资源，只有TCB和堆栈，共享地址空间，是处理器调度基本单位。

## 多线程



# 同步与互斥

## 进程互斥

### 并发原理

消费者和生产者问题

生产者将数据转入缓冲区（buffer），消费者进程从缓冲区（buffer）中提取数据，

两个进程交叉访问共享变量时产生错误，并发进程中与共享变量有关的程序段称为临界区，一次只允许一个进程使用的资源称为临界资源。进程中访问临界资源的那段代码称为临界区。

### 互斥（Mutual Exclusion）

一个进程在临界区中执行时，不让另一个进程进入相关的临界区执行，就不会造成与时间有关的错误。不允许两个以上共享共有资源或变量的进程同时进入临界区执行的性质称为互斥。

临界区管理应有三个要求：

1. 互斥性
2. 进展性
3. 有限等待性

### 信号量与PV操作

在多个相互合作的进程之间使用简单的信号来协调控制，一个进程检测到某个信号后，就被强迫停止在一个特定的地方，直到他收到一个专门的信号为止才能继续执行，这个信号就称为信号量。

## 进程同步

**进程同步的引入** 生产者消费者问题中，消费者从一个空的缓冲区中提取数据

## 进程通信

### 进程通信的类型

- 共享存储器系统：相互通信的进程共享某些数据结构或存储区域
- 消息传递系统：进程间的数据交换以消息为单位
- 管道通信：用管道连接一个读进程和一个写进程以实现进程之间通信的一种共享文件，发送进程向管道输入数据，接受进程从管道接受数据，形成通信。

### 进程通信的有关问题

**缓冲问题**

**并行性问题**

## 死锁

**死锁的必要条件**

1. 互斥条件
2. 部分分配条件
3. 不可抢占条件
4. 循环等待条件





荷兰计算机科学家 Dijkstra 于1965年提出了一个信号量和PV操作的同步机构。在 P、V 操作中会用到进程控制原语，其中 P 操作用到了**阻塞原语**，在 V 操作中用到了 **唤醒原语**。

# 处理机调度

## 处理器调度层次

### 作业调度

根据进程控制块中的信息，按照某种原则从外存的后备队列中选取一个或几个进程调入内存，并创建进程和分配必要的资源，然后再将新创建的进程插入就绪队列。

### 中级调度

负责内外存之间的进程对换，以解决内存紧张的问题，即他将内存中处于等待状态的某些进程调到外存对换区以腾出内存空间，再将内存对换区中已具备运行条件的进程重新调入内存准备运行。

### 短程调度

短程调度也成为低级调度或**进程调度**，所调度的对象是进程。它决定就绪队列中哪个进程或线程将获得处理器，并将处理器分配给该进程或者线程。

进程调度的功能：

1. 保护当前正在执行进程的现场，将程序状态寄存器、指令计数器及所有通用寄存的内容放到特定单元保留起来。
2. 查询、登记和更新进程控制块 PCB 中的相应表项，从就绪进程中选择一个并把 CPU 分配给他。
3. 回复被调度到的进程的原来现场。

进程调度分为**剥夺式**与**非剥夺式**。

## 单处理机调度算法

### 处理机调度功能与标准

调度算法准则：

1. 资源利用率
2. 平衡资源
3. 响应时间
4. 周转时期：一个进程从提交到完成之间的时间间隔称为周转时间，这是批处理系统衡量调度性能的一个重要指标。
5. 吞吐量：每个单位时间完成的进程数。
6. 公平性

### 常用调度算法

- **先来先服务调度**

  也称先进先出或严格排队方案，即先请求处理器的进程先分配到处理器，直到该进程运行结束或者发生等待。

- **时间片轮转法**

  每个进程被分配一个时间段，称为时间片，即允许该进程在该时间段中运行。如果在时间片结束时该进程还在运行，则将剥夺CPU并分配给另一个进程。如果时间片无限延长，那么时间片轮转法就会退化成先来先服务调度算法。

- **最短进程优先**

  最短进程优先策略是一种非抢占的策略，原则是选择所需处理时间最短的进程占有CPU运行，最短进程优先算法客服了 FCFS 偏爱长进程的缺点，易于实现。但其需要预先知道进程所需CPU时间，且忽略了进程等待时间。

- **优先级调度**

  每个进程被赋予一个优先级，允许优先级最高的可运行进程运行。

  为了防止高优先级进程无休止地运行下去，调度程序可能在每个时钟终端降低进程的优先级，如果这一行为导致该进程的优先级低于次高优先级的进程，则进行进程切换。另一种方法是给每个进程赋予一个允许运行的最大时间片，当用完这个时间片时次高优先级的进程便会获得运行机会。

- **多级反馈队列轮换法**

# 内存管理

## 存储管理的功能

目前许多计算机把存储器分为三级：外存、主存和缓存。

存储管理具有四个功能，分别是**存储空间的分配和回收**、**地址变换与重定位**、**存储共享与保护**、**主存扩充**。

## 存储分配的几种形式与重定位

直接存储分配方式

静态存储分配方式：在将作业装入内存时才确定他们在内存中的位置，运行时固定不变

动态存储分配方式：不一次性将程序全部装入主存，而是根据执行需要动态装入和回首，也可动态申请存储空间

### 重定位

### 覆盖与交换

## 分区存储管理



## 页式存储管理

分区管理

## 页面置换算法

- **最优页面置换算法**，
- **最近未使用页面置换算法**
- **先进先出页面置换算法**
- **第二次机会页面置换算法**，改进后的先进先出，基于页面一个 R 位来判断最近有没有使用过
- **最近最少使用页面置换算法**
- **时钟页面置换算法**



# 文件系统

例题 Consider the organization of a UNIX file as represented by the i-node. Assume that there are 10 direct block pointers, and a singly, doubly, and triply indirect pointer in each i-node. Further, assume that the system block size and the disk sector size are both 4K.

1. Please describe the structure of i-nodes and data blocks;

2. Assume the size of one data block is 4KB, the disk address is represented as 4 byte unsigned intergers, what is the maximum size of the file that the file system can create?

3. If the disk block pointer is 32 bits, with 8 bits to identify the physical disk and 24 bits to identify the pysical block, then

   a. What is the maximum file size supported by this system?

   b. What is the maximum file system partition supported by this system?

   c. Assuming no infromation other than that the file i-node is already in main memory, how many disk accesses are required to access the byte in position 4321281?

# 设备管理

通常将处理器和主存以外的设备成为外部设备或 I/O 设备。

## I/O 设备管理概述

### I/O 系统组成

I/O 系统由 I/O 设备、设备控制器、通道和 I/O 统一接口组成。

I/O 设备：用于完成数据的输入输出

设备控制器：用于控制对应的 I/O 设备

通道：用于数据传输（总线型或通道型）

I/O 统一接口：为不同设备的使用提供统一的接口

![image-20250604211925420](/home/cacc/.config/Typora/typora-user-images/image-20250604211925420.png)

# 操作系统安全