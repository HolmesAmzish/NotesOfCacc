不必每次手动操作 😄——你完全可以把这个流程自动化，让开机后 **副屏自动启用**，即使桌面跑在 AMD 集显。

根据你目前的硬件环境（AMD 集显 + NVIDIA 独显 + HDMI 接口直连 NVIDIA），下面是完整解决方案：

---

## 1️⃣ 临时手动启动副屏（你之前的流程）

每次开机如果想手动开启：

`# 绑定 NVIDIA 输出给 AMD xrandr --setprovideroutputsource "NVIDIA-G0" "AMD Radeon 780M @ pci:0000:06:00.0"  # 自动检测 HDMI 并启用 xrandr --auto  # 将 HDMI 副屏放在右边 xrandr --output HDMI-1-0 --auto --right-of eDP`

- 这是临时生效的，每次重启后需要重新执行。

---

## 2️⃣ 自动化开机启动副屏

### 方法 A：放入 `~/.xprofile`（最简单）

1. 打开或创建文件：

`nano ~/.xprofile`

2. 添加以下内容：

`#!/bin/bash xrandr --setprovideroutputsource "NVIDIA-G0" "AMD Radeon 780M @ pci:0000:06:00.0" xrandr --auto xrandr --output HDMI-1-0 --auto --right-of eDP`

3. 保存并退出 (`Ctrl+O`, `Ctrl+X`)

4. 给文件加执行权限：

`chmod +x ~/.xprofile`

✅ 好处：

- 每次登录 X11 桌面时自动执行，无需手动操作

- 保持桌面在 AMD 集显状态，副屏自动工作

---

### 方法 B：系统启动脚本（全用户生效）

1. 创建 systemd 用户服务：

`mkdir -p ~/.config/systemd/user nano ~/.config/systemd/user/hdmi-autostart.service`

2. 内容：

`[Unit] Description=Enable HDMI output on login After=graphical.target  [Service] Type=oneshot ExecStart=/home/cacc/enable_hdmi.sh  [Install] WantedBy=default.target`

3. 创建 `enable_hdmi.sh` 脚本（同前）：

`nano ~/enable_hdmi.sh`

内容：

`#!/bin/bash xrandr --setprovideroutputsource "NVIDIA-G0" "AMD Radeon 780M @ pci:0000:06:00.0" xrandr --auto xrandr --output HDMI-1-0 --auto --right-of eDP`

4. 给执行权限：

`chmod +x ~/enable_hdmi.sh`

5. 启用服务：

`systemctl --user enable hdmi-autostart.service systemctl --user start hdmi-autostart.service`

✅ 好处：

- 每次开机自动执行，无需登录手动运行命令

- 适合 KDE/GNOME/Xfce 等桌面环境

---

### 方法 C：使用桌面环境自带“启动应用”

- GNOME / KDE 都有“启动应用”选项

- 添加 `enable_hdmi.sh` 脚本即可开机自动执行

---

## 3️⃣ 注意事项

1. **Wayland vs X11**：
   
   - `xrandr` 仅在 **X11 会话** 下生效
   
   - Wayland 可能需要不同方法（GNOME Shell 扩展或 NVIDIA 官方设置）
   
   - 如果你默认用 Wayland，建议切换到 Xorg 会话

2. **保持 HDMI Provider 名称一致**
   
   - 如果 NVIDIA Provider 名称改变（更新驱动后），需要调整脚本中 `"NVIDIA-G0"` 和 AMD 名称

---

💡 总结：

- **第一次开机**，你只需设置脚本一次

- **以后每次开机/登录**，系统会自动绑定 NVIDIA 输出并启用副屏

- 无需手动重复 `xrandr` 命令

---

我可以帮你直接写好一个 **开箱即用的一键脚本**，放在 `~/enable_hdmi.sh`，登录 X11 后自动启用副屏，兼容 GNOME/KDE。

你希望我直接帮你生成吗？
